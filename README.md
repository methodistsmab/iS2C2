# iS2C2: A Co-Intelligent Platform for Mechanistic Discovery of Disease Cellular Crosstalk

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![R](https://img.shields.io/badge/R-4.3.1+-blue.svg)](https://www.r-project.org/)
[![Python](https://img.shields.io/badge/Python-3.8+-green.svg)](https://www.python.org/)
[![Ollama](https://img.shields.io/badge/Ollama-Local%20LLM-orange.svg)](https://ollama.ai/)
[![Gemini](https://img.shields.io/badge/Gemini-API-red.svg)](https://ai.google.dev/gemini-api/docs)
[![OpenRouter](https://img.shields.io/badge/OpenRouter-API-purple.svg)](https://openrouter.ai/)


## Table of Contents
- [iS2C2: A Co-Intelligent Platform for Mechanistic Discovery of Disease Cellular Crosstalk](#is2c2-a-co-intelligent-platform-for-mechanistic-discovery-of-disease-cellular-crosstalk)
  - [Introduction](#introduction)
  - [Key Features](#key-features)
  - [Overview](#overview)
  - [Update](#update)
  - [System Requirements](#system-requirements)
  - [Installation](#installation)
    - [LLM tool package install](#llm-tool-package-install)
    - [Ollama download & Install](#ollama-download--install)
  - [Tutorial](#tutorial)
    - [Running cell-cell interaction using iS2C2](#running-cell-cell-interaction-using-is2c2)
    - [Running cell-cell interaction using LIANA+ and LLMs](#running-cell-cell-interaction-using-liana-and-llms)
    - [Running cell-cell interaction using NicheNet and LLMs](#running-cell-cell-interaction-using-nichenet-and-llms)
  - [Expected Output](#expected-output)
  - [Acknowledgements](#acknowledgements)
  - [Citation](#citation)

## Introduction

This repository provides a **fully automated pipeline for hypothesis generation from cell-cell communication (CCC) data using large language models (LLMs)**, built for **scalability, transparency, and ease of use**. The current version supports single-cell and spatial transcriptomics data, including 10x datasets for human and mouse samples.

Unlike traditional approaches that require manual interpretation of omics data outputs, our pipeline combines computational algorithms with LLMs to **automate the generation of interpretable biological hypotheses**. 

## Key Features

- **✅ Fully Automated Workflows with API Integration**  
The pipeline is optimized for **completely automated execution** via **local OpenModels (e.g., Ollama)** and **API Call Functions (e.g., Gemini, OpenRouter)**, streamlining the entire process from input data to hypothesis generation.  
 *Note: Chatbox interfaces for ChatGPT or KIMI can be used but require some **manual steps** for interaction.*

- **✅ Example Datasets and Transparent Tutorials**  
Includes curated **example datasets** and **step-by-step tutorials** with **clear outputs at every stage**, enabling easy testing, customization, and reproducibility.

- **✅ Multi-Source CCC Compatibility**  
Seamlessly integrates outputs from multiple CCC pipelines such as **[S2C2](https://github.com/methodistsmab/S2C2)**, **[LIANA+](https://liana-py.readthedocs.io/en/latest/)**, and **[NicheNet](https://github.com/saeyslab/nichenetr)**, enabling flexible use of various upstream analyses before LLM-powered hypothesis generation.

- **✅ Fully compatible with both single-cell and spatial transcriptomics datasets**  
Supports seamless analysis and hypothesis generation for both data types without additional configuration.


## Overview

This platform bridges the gap between **structured computational data analysis** and **generative AI reasoning**. By automating both data processing and biological interpretation steps, it enables:

- Scalable and reproducible hypothesis generation
- Domain-specific interpretability
- Supports both **single-cell** and **spatial transcriptomics** data

This approach was optimized for accuracy, repeatability, and interpretability. We validated our findings using two use cases: one focused on Alzheimer's disease and the other on cancer datasets.

> Disclaimer: The results generated by this algorithm may include speculative or AI-generated associations. Users are advised to evaluate all outputs through independent literature review and critical analysis.



## Update

**[2025.8.1]** The current iS2C2 supports S2C2 with LLM interpretation, LIANA+ with LLM interpretation, and NicheNet with LLM interpretation. The current version supports single-cell and spatial transcriptomics data for both human and mouse samples, and will generate 3 hypotheses for each cell-cell communication prediction.

---

## System Requirements

| Component | Minimum | Recommended |
|-----------|---------|-------------|
| RAM | 8GB | 16GB+ |
| Storage | 10GB | 50GB+ |
| CPU | 4 cores | 8+ cores |
| GPU | Optional | NVIDIA GPU for faster LLM inference |
> **Platform Compatibility**: This platform is optimized for **macOS and Linux** systems. Windows users are recommended to use the S2C2 GUI interface and chatbox functionality for optimal performance.

---

## Installation

```bash
git clone https://github.com/methodistsmab/iS2C2.git
cd iS2C2
```

### LLM tool package install
Use Python 3.9
```bash
conda create -n is2c2 python=3.9
conda activate is2c2
```

Install Python packages
```bash
pip install -r requirements.txt
```

### Ollama download & Install
1. Visit the [Ollama official website](https://ollama.com/download)
2. Download the installer for your operating system
3. Follow the installation instructions included with the downloaded installer

---
## Tutorial

### Running cell-cell interaction using iS2C2

- [iS2C2 with local OpenModel (Ollama as the example)](./tutorial/iS2C2/iS2C2-ollama-tutorial.md)
- [iS2C2 with API Call Function](./tutorial/iS2C2/iS2C2-gemini-tutorial.md)
  - [Gemini as the example](./tutorial/iS2C2/iS2C2-gemini-tutorial.md)
  - [OpenRouter using OpenAI LLM API as the example](./tutorial/iS2C2/iS2C2-openrouter-tutorial.md)
- [iS2C2 with Chatbox](./tutorial/iS2C2/iS2C2-chatbox-tutorial.md)

### Running cell-cell interaction using LIANA+ and LLMs

- [LIANA+ with local OpenModel (Ollama as the example)](./tutorial/LIANA_plus/liana-plus-ollama-tutorial.md)
- [LIANA+ with API Call Function](./tutorial/LIANA_plus/liana-plus-gemini-tutorial.md)
  - [Gemini as the example](./tutorial/LIANA_plus/liana-plus-gemini-tutorial.md)
  - [OpenRouter using OpenAI LLM API as the example](./tutorial/LIANA_plus/liana-plus-openrouter-tutorial.md)
- [LIANA+ with Chatbox](./tutorial/LIANA_plus/liana-plus-chatbox-tutorial.md)

### Running cell-cell interaction using NicheNet and LLMs

- [NicheNet with local OpenModel (Ollama as the example)](./tutorial/NicheNet/nichenet-ollama-tutorial.md)
- [NicheNet with API Call Function](./tutorial/NicheNet/nichenet-gemini-tutorial.md)
  - [Gemini as the example](./tutorial/NicheNet/nichenet-gemini-tutorial.md)
  - [OpenRouter using OpenAI LLM API as the example](./tutorial/NicheNet/nichenet-openrouter-tutorial.md)
- [NicheNet with Chatbox](./tutorial/NicheNet/nichenet-chatbox-tutorial.md)


---

## Expected Output

The **final report** is generated in the file:  
```llm_report_*.txt```

This file contains a structured summary of the hypotheses generated by the pipeline.

### ✅ Example Report Output
![example](/screenshots/example-main-output.png)

## Acknowledgements

We are deeply grateful for the open source software that powers our research and this project. 
- [NicheNet](https://github.com/saeyslab/nichenetr)
- [LIANA+](https://liana-py.readthedocs.io/en/latest/notebooks/basic_usage.html)
- [CellChat](https://github.com/sqjin/CellChat)
- [Scanpy](https://github.com/scverse/scanpy)
- [Seurat](https://satijalab.org/seurat/)
- [SeuratData](https://github.com/satijalab/seurat-data)
- [Ollama](https://ollama.com/)
- [OpenRouter](https://openrouter.ai/)

## Citation

If you use iS2C2-llm cointelligence in your research, please cite:

```bibtex
@article{Sheng2025iS2C2,
title={{iS2C2: A Co-Intelligent Platform for Mechanistic Discovery of Disease Cellular Crosstalk}},
author={Jianting Sheng, Juyoung Ahn, Li Yang, Zhihao Wan, et al.},
journal={{[Journal Name - To be filled upon publication]}},
year={2025}
}
```
